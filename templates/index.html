{% extends "base.html" %}{% block content %}
<h2>Anonote -åŒ¿åã™ãã‚‹æ²ç¤ºæ¿-</h2>
<a href="/login">ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</a>
<a href="/admin">ç®¡ç†è€…ç”»é¢</a>
<a href="https://github.com/newhonke/Anonote">github</a>
<form action="/" method="post" class="post-form">
    <label>æŠ•ç¨¿</label>
    <input type="text" name="note" required>
    <input type="hidden" name="reply_to" id="reply_to_input" value="">
    <div id="reply_info"></div>
    <button type="button" id="cancel_reply" style="display:none;">è¿”ä¿¡ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
    <input type="submit" value="æŠ•ç¨¿">
</form>

<div class="timeline">
{% for note in notes %}
    <div id="note-{{ note.id }}" class="note" data-post-id="{{ note.id }}">
    <div class="time">
    {% if note.user and note.user.is_admin %}
        <p style="color: red;"><small>({{ note.created_at | to_jst }})</small></p>
    {% else %}
        <small>({{ note.created_at | to_jst }})</small>
    {% endif %}
    </div>

    <div class="reply">
    {% if note.reply_to %}
        {% set parent = parent_map.get(note.reply_to) %}
        {% if parent %}
            è¿”ä¿¡å…ƒ:<a href="#note-{{ parent.id }}">{{ parent.post }}</a>
        {% endif %}
    {% endif %}
    </div>
    <div class="note-content">
    {% if note.renote_from_id %}
        <div class="renote">
        {% set original = parent_map.get(note.renote_from_id) %}
        {% if original %}
            <p class="renote-label">ãƒªãƒãƒ¼ãƒˆã•ã‚Œã¾ã—ãŸ</p>
            <blockquote>{{ original.post }}</blockquote>
        {% else %}
            <p>ãƒªãƒãƒ¼ãƒˆå…ƒã¯å‰Šé™¤ã•ã‚Œã¦ã„ã¾ã™</p>
        {% endif %}
        </div>
    {% else %}
        <p>{{ note.post }}</p>
    {% endif %}
    </div>
    
    {% if note.post and not note.renote_from_id %}
        <a href="#" class="reply-btn icon-btn" data-reply-to="{{ note.id }}"><i class="fa-solid fa-reply"></i></a>
        <a href="{{ url_for('renote', id=note.id) }}" class="icon-btn">
            <i class="fa-solid fa-retweet"></i>
        </a>
    {% endif %}
    <span class="note-footer">
        <span class="reactions">
            {% for reaction in reactions[note.id] %}
                <span data-emoji="{{ reaction.emoji }}">{{ reaction.emoji }} Ã— {{ reaction.count }}</span>
            {% endfor %}
        </span>
        <a href="#" class="add-reaction icon-btn"><i class="fa-solid fa-plus"></i></a>
        <span class="emoji-picker hidden">
            <span class="emoji">ğŸ‘</span>
            <span class="emoji">ğŸ˜‚</span>
            <span class="emoji">â¤ï¸</span>
            <span class="emoji">ğŸ‰</span>
        </span>
    </span>
    </div>
{% else %}
<div class="not_note"><p>noteãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p></div>    
{% endfor %}
</div>
{% endblock %}